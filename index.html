<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¬øQuieres ser mi San Valent√≠n? üíï</title>
    <style>
        /* --- ESTILOS GENERALES --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ff6b9d 0%, #c06c84 50%, #f67280 100%);
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            overflow-y: auto;
            position: relative;
        }

        /* Capa de fondo para la lluvia */
        #lluviaFondo {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 1;
            overflow: hidden; /* Asegura que no se salga nada */
        }

        /* Contenedores de las pantallas */
        .container-base {
            text-align: center; background: rgba(255, 255, 255, 0.95);
            padding: 40px 20px; border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%; max-width: 600px; z-index: 10; margin: 20px;
            position: relative;
        }

        h1, h2 { color: #ff1744; margin-bottom: 20px; }
        .emoji { font-size: 5em; animation: latido 1.5s infinite; }
        
        @keyframes latido { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

        /* --- BOTONES --- */
        .botones { display: flex; gap: 20px; justify-content: center; margin-top: 30px; flex-wrap: wrap; }
        button {
            padding: 15px 30px; font-size: 1.2em; border: none; border-radius: 15px;
            cursor: pointer; font-weight: bold; transition: 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        .btn-si { background: #4CAF50; color: white; }
        .btn-no { background: #f44336; color: white; position: relative; }
        .btn-nosotros { background: #ff6b9d; color: white; margin-top: 30px; width: 100%; }

        /* --- TICKETS --- */
        .tickets-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .ticket { background: linear-gradient(135deg, #ff6b9d, #c06c84); color: white; padding: 15px; border-radius: 12px; text-align: left; }

        /* --- CARRUSEL --- */
        .carrusel-wrapper {
            position: relative; width: 100%; overflow: hidden;
            border-radius: 20px; background: #000; margin: 20px 0;
        }

        .carrusel-container {
            display: flex; overflow-x: auto; scroll-behavior: smooth;
            scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;
        }
        .carrusel-container::-webkit-scrollbar { display: none; }

        .carrusel-slide {
            flex: 0 0 100%; scroll-snap-align: center;
            display: flex; justify-content: center; align-items: center;
            height: 400px;
        }
        .carrusel-slide img { max-width: 100%; max-height: 100%; object-fit: contain; }

        /* --- ANIMACI√ìN DE CAIDA CORREGIDA --- */
        .elemento-caida {
            position: absolute;
            top: -50px; /* Empieza fuera de la pantalla */
            font-size: 2em;
            animation-name: caer;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
            opacity: 0.8; /* Hacemos que sean visibles por defecto */
        }

        @keyframes caer {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            80% {
                opacity: 1;
            }
            100% {
                transform: translateY(110vh); /* Cae hasta el final de la pantalla */
                opacity: 0; /* Se desvanece al final */
            }
        }

        .hidden { display: none !important; }
    </style>
</head>
<body onclick="iniciarMusicaUno()">

    <div id="lluviaFondo"></div>

    <div class="container-base" id="preguntaContainer">
        <div class="emoji">üíï</div>
        <h1>¬øQuieres ser mi San Valent√≠n?</h1>
        <div class="botones">
            <button class="btn-si" onclick="aceptar()">S√ç üíñ</button>
            <button class="btn-no" id="btnNo" onclick="rechazar()">NO</button>
        </div>
    </div>

    <div class="container-base hidden" id="gifContainer">
        <h2>¬°Ay nooo! ü•∫</h2>
        <img src="https://media1.tenor.com/m/fTTVgygGDh8AAAAC/sad-pepe-cry.gif" alt="Triste" style="width:100%; border-radius:15px;">
        <button class="btn-nosotros" onclick="volverAPregunta()">Volver a intentar</button>
    </div>

    <div class="container-base hidden" id="aceptacionContainer">
        <div class="emoji">‚ù§Ô∏è</div>
        <h2 style="font-size: 2em;">¬°TE AMO MUCHO!</h2>
        <div class="tickets-grid">
            <div class="ticket"><b>üë£ Masaje gratis</b><br>V√°lido siempre ‚ú®</div>
            <div class="ticket"><b>üíã Mekatito</b><br>V√°lido siempre ‚ú®</div>
            <div class="ticket"><b>üíÜ‚Äç‚ôÄÔ∏è Masaje cuerpo</b><br>V√°lido siempre ‚ú®</div>
            <div class="ticket"><b>üíÑ Gloss</b><br>V√°lido siempre ‚ú®</div>
            <div class="ticket"><b>üë∂ Nuevo bebe</b><br>V√°lido siempre ‚ú®</div>
            <div class="ticket"><b>üí´ Acomodada matriz</b><br>V√°lido siempre ‚ú®</div>
        </div>
        <button class="btn-nosotros" onclick="irANosotros()">Nosotros ‚ù§Ô∏è</button>
    </div>

    <div class="container-base hidden" id="nosotrosContainer">
        <h2>Nuestros Momentos ‚ú®</h2>
        <div class="carrusel-wrapper">
            <div class="carrusel-container" id="carrusel">
                </div>
        </div>
        <p id="contador" style="font-weight: bold; color: #ff1744;">Foto 1 / 16</p>
        <button class="btn-no" onclick="irABonos()" style="margin-top: 20px;">‚Üê Volver a Bonos</button>
    </div>

    <audio id="musicaUno" loop><source src="uno.mp3" type="audio/mpeg"></audio>
    <audio id="musicaTriste" loop><source src="esto-es-un-ratito.mp3" type="audio/mpeg"></audio>
    <audio id="musicaAmor" loop><source src="amor.mp3" type="audio/mpeg"></audio>
    <audio id="musicaDos" loop><source src="dos.mp3" type="audio/mpeg"></audio>

    <script>
        let contadorRechazos = 0;
        let musicaUnoIniciada = false;
        let autoplayInterval;
        let emojiActual = '‚ù§Ô∏è'; // Emoji por defecto

        const audios = {
            uno: document.getElementById('musicaUno'),
            triste: document.getElementById('musicaTriste'),
            amor: document.getElementById('musicaAmor'),
            dos: document.getElementById('musicaDos')
        };

        // --- L√ìGICA DE LA LLUVIA CORREGIDA ---
        function crearLluvia() {
            const fondo = document.getElementById('lluviaFondo');
            setInterval(() => {
                const c = document.createElement('div');
                c.className = 'elemento-caida';
                c.textContent = emojiActual;
                c.style.left = Math.random() * 95 + '%'; // Usamos % para evitar scroll horizontal
                c.style.animationDuration = (Math.random() * 3 + 2) + 's'; // Duraci√≥n entre 2s y 5s
                c.style.fontSize = (Math.random() * 20 + 20) + 'px';
                fondo.appendChild(c);
                
                // Elimina el elemento despu√©s de caer (5s es suficiente)
                setTimeout(() => c.remove(), 5000);
            }, 200); // Crea un nuevo emoji cada 200ms
        }
        crearLluvia();

        function cambiarLluvia(tipo) {
            const fondo = document.getElementById('lluviaFondo');
            fondo.innerHTML = ''; // Limpia los emojis anteriores
            emojiActual = tipo;
        }

        // --- M√öSICA Y NAVEGACI√ìN ---
        function iniciarMusicaUno() {
            if (!musicaUnoIniciada) {
                audios.uno.play().catch(() => {});
                musicaUnoIniciada = true;
            }
        }

        function detenerTodosLosAudios() {
            Object.values(audios).forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });
        }

        function rechazar() {
            contadorRechazos++;
            if (contadorRechazos >= 5) {
                detenerTodosLosAudios();
                document.getElementById('preguntaContainer').classList.add('hidden');
                document.getElementById('gifContainer').classList.remove('hidden');
                audios.triste.play();
                
                // CAMBIO A CORAZONES ROTOS
                cambiarLluvia('üíî');
            } else {
                const btn = document.getElementById('btnNo');
                const container = document.getElementById('preguntaContainer').getBoundingClientRect();
                // Aseguramos que el bot√≥n se mantenga dentro del contenedor
                const maxX = container.width - btn.offsetWidth - 20;
                const maxY = container.height - btn.offsetHeight - 20;
                
                btn.style.position = 'absolute';
                btn.style.left = Math.random() * maxX + 'px';
                btn.style.top = Math.random() * maxY + 'px';
            }
        }

        function aceptar() {
            detenerTodosLosAudios();
            audios.amor.play();
            mostrarPantalla('aceptacionContainer');
            cambiarLluvia('‚ù§Ô∏è'); // Aseguramos corazones felices
        }

        function volverAPregunta() {
            contadorRechazos = 0;
            detenerTodosLosAudios();
            audios.uno.play();
            document.getElementById('btnNo').style.position = 'relative';
            document.getElementById('btnNo').style.left = 'auto';
            document.getElementById('btnNo').style.top = 'auto';
            mostrarPantalla('preguntaContainer');
            
            // VOLVER A CORAZONES FELICES
            cambiarLluvia('‚ù§Ô∏è');
        }

        function mostrarPantalla(id) {
            ['preguntaContainer', 'gifContainer', 'aceptacionContainer', 'nosotrosContainer'].forEach(p => {
                document.getElementById(p).classList.add('hidden');
            });
            document.getElementById(id).classList.remove('hidden');
            window.scrollTo(0,0);
        }

        function irANosotros() {
            detenerTodosLosAudios();
            audios.dos.play();
            mostrarPantalla('nosotrosContainer');
            prepararCarrusel();
            // Mantiene corazones felices
        }

        function irABonos() {
            clearInterval(autoplayInterval);
            detenerTodosLosAudios();
            audios.amor.play();
            mostrarPantalla('aceptacionContainer');
        }

        // --- CARRUSEL ---
        function prepararCarrusel() {
            const carrusel = document.getElementById('carrusel');
            if (carrusel.children.length === 0) {
                for (let i = 1; i <= 16; i++) {
                    const slide = document.createElement('div');
                    slide.className = 'carrusel-slide';
                    slide.innerHTML = `<img src="${i}.jpg" alt="Foto ${i}">`;
                    carrusel.appendChild(slide);
                }
            }
            
            clearInterval(autoplayInterval);
            autoplayInterval = setInterval(() => {
                const scrollLeft = carrusel.scrollLeft;
                const width = carrusel.offsetWidth;
                if (scrollLeft + width >= carrusel.scrollWidth - width / 2) {
                    carrusel.scrollTo({ left: 0, behavior: 'smooth' });
                } else {
                    carrusel.scrollBy({ left: width, behavior: 'smooth' });
                }
            }, 3000);

            carrusel.addEventListener('scroll', () => {
                const index = Math.round(carrusel.scrollLeft / carrusel.offsetWidth) + 1;
                document.getElementById('contador').textContent = `Foto ${index} / 16`;
            });
        }
    </script>
</body>
</html>
